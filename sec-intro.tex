\section{Introduction}
\label{ch:intro}
Before getting lost in many technicalities, there have been reported a small
introduction to the GRAPES library. It is a generic environment for P2P
streaming. It is designed to be usable in different environments and
situations. Peer-to-peer (\textbf{P2P}) tecnologies are becoming increasingly
popular as a way to overcome the scalability problem limitations intrinsic in
traditional applications based on client/server paradigm. In particular there
is a great interest in P2P streaming applications because they have high
demands in term of bandwidth requirements and IP-level multicasting is not
supported on the internet.
More details could be found in \cite{disi10-038}.

The \textbf{GRAPES} library provides a net-helper for managing the
communication. At the beggining, it was using the \textit{UDP} protocol on POSIX
systems. As it is known, \textit{UDP} is commonly used in internet for streaming audio and video,
whereas it is avoided in contexts where the content of the transmitted data is relevant.
The reason for implementing a \textit{TCP}-communication module that works in a context where
commonly \textit{UDP} is used, is given by the need of 'guaranteeing delivery'.
Some features for this are intrinsecally given by \textit{TCP}:
\begin{itemize}
\item \textbf{flow control}: it determines when data needs to be re-sent and stops flow of data until
  previous packes are successfully transeferred.
\item \textbf{re-transimittion}: if the data is lost or collision have occur during transmition.
\end{itemize}
Some other functionalities have been created in order to takle disadvantages that \textit{TCP} has
respect to \textit{UDP}:
\begin{itemize}
\item \textbf{dictionary}: a manager for the set of connections in order to keep them `alive'.
                          Commonly \textit{TCP} is used in 'single-shot' mode: the transition is
                          used for delivering a packet and the connection is closed once it has
                          been completely transferred. This is an waste of resources in an
                          environment where is exchanged a high rate of packets.
\item \textbf{states machines}: for both sender and receiver peers have been builded a state machine
                                that permites to them to be in consistent state.
\item \textbf{timeout}: connections are closed when a predefined timeout expires.
\end{itemize}

In this report we will explain the internals of the tcp-communication module.
In particular, we will focus on three main functions that are involved:
\begin{itemize}
  \item \textit{send\_to\_peer}:
  \item \textit{recv\_from\_peer}:
  \item \textit{wait4data}:
\end{itemize}

